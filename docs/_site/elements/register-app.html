<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Register an App for API Access </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Register an App for API Access ">
      
      
      <link rel="icon" href="../favicon.ico">
      <link rel="stylesheet" href="../public/docfx.min.css">
      <link rel="stylesheet" href="../public/main.css">
      <meta name="docfx:navrel" content="../toc.html">
      <meta name="docfx:tocrel" content="toc.html">
      
      <meta name="docfx:rel" content="../">
      
      
      
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../index.html">
            <img id="logo" class="svg" src="../logo.svg" alt="">
            
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="register-an-app-for-api-access">Register an App for API Access</h1>

<p>Complete the following steps to register an app for the AvePoint Graph API:</p>
<ol>
<li>Sign in to Elements with your account.</li>
<li>Go to the <strong>Settings</strong> page and select <strong>API app registration</strong> in the <strong>Additional</strong> area.</li>
<li>On the <strong>API app registration</strong> page, click <strong>Create app registration</strong> under the <strong>Public API</strong> tab.</li>
<li>In the <strong>Basic information</strong> step, enter a name for the app and select the corresponding permissions that you need to grant to this app.</li>
<li>In the <strong>Customer scope</strong> step, select <strong>All customers</strong>, <strong>Specific customers</strong>, or <strong>Customer groups</strong> as the scope.</li>
<li>In the <strong>Certificates and secrets</strong> step, configure the credentials. Credentials enable applications to identify themselves to the authentication service when receiving tokens at a web addressable location (using an HTTPS scheme). For a higher level of assurance, we recommend using a certificate (instead of a client secret) as a credential. Follow the instructions below to configure credentials:
<ul>
<li>Select the <strong>Certificate</strong> tab, and then click <strong>Upload certificate</strong> to upload a certificate (<code>.cer</code> file). The certificate serves as credentials that allow your application to authenticate itself, requiring no interaction from a user at runtime. You can refer to <a href="#prepare-a-certificate">Prepare a Certificate</a> to prepare a certificate.</li>
<li>Select the <strong>Client secret</strong> tab, click <strong>Add client secret</strong>, set the effective duration to 1 year, 2 years, or 3 years, and then click <strong>Add</strong> to generate a client secret. Client secret values cannot be entirely shown once they are saved. To get a client secret value for later use, copy and save it upon creation.</li>
</ul>
</li>
<li>Click <strong>Save</strong> to save your configurations.</li>
</ol>
<p>When you finish the registration, click the app name and you can copy the generated Application (Client) ID on the <strong>App registration details</strong> page.</p>
<h2 id="prepare-a-certificate">Prepare a Certificate</h2>
<p>To prepare self-signed certificate files based on your scenario, choose one of the following methods.</p>
<p><strong>Use a Key Vault in Azure to Prepare Certificates</strong></p>
<p>Before preparing a certificate with this method, make sure you have a key vault in Azure. If you have an Azure subscription but do not have any key vaults, refer to the instructions below to create a Key Vault in Azure.</p>
<p>Make sure you have an Azure subscription that contains Azure Key Vault. Then follow the instructions below:</p>
<ol>
<li><p>Create an application. This application is only used for Azure Key Vault.</p>
<blockquote>
<p>a. In the Microsoft Entra admin center (or Microsoft Azure portal), navigate to <strong>Identity &gt; Applications &gt; App registrations</strong> (or <strong>Microsoft Entra ID &gt; App registrations</strong>).</p>
</blockquote>
<blockquote>
<p>b. Click <strong>New registration</strong>.</p>
</blockquote>
<blockquote>
<p>c. On the <strong>Register an application</strong> page, configure the application settings.</p>
</blockquote>
<blockquote>
<p>d. Click <strong>Register</strong> to create your application.</p>
</blockquote>
<blockquote>
<p>e. After the application is created, copy the application ID.</p>
</blockquote>
</li>
<li><p>Add a client secret for the application.</p>
<blockquote>
<p>a. After creating the application, click <strong>Certificates &amp; secrets</strong> in the left menu.</p>
</blockquote>
<blockquote>
<p>b. In the <strong>Client secrets</strong> field, click <strong>New client secret</strong>.</p>
</blockquote>
<blockquote>
<p>c. In the <strong>Add a client secret</strong> pane, enter a description for the client secret and select a duration.</p>
</blockquote>
<blockquote>
<p>d. Click <strong>Add</strong>. The value of the client secret is automatically generated and displayed.</p>
</blockquote>
<blockquote>
<p>e.  Copy the client secret value. You will need to provide the value when configuring the encryption profile.</p>
</blockquote>
<blockquote>
<p><strong>Note:</strong>
The value will be hidden after you leave or refresh the page.</p>
</blockquote>
</li>
<li><p>Create a key vault.</p>
<blockquote>
<p>a. In the Microsoft Azure portal, enter <strong>Key vaults</strong> in the search box on the top, and then select the first result to access the <strong>Key vaults</strong> page.</p>
</blockquote>
<blockquote>
<p>b. Click <strong>Create</strong>. The <strong>Create a key vault</strong> page appears.</p>
</blockquote>
<blockquote>
<p>c. In the <strong>Basics</strong> tab, provide the basic information for the key vault, and then click the <strong>Access configuration</strong> tab.</p>
</blockquote>
<blockquote>
<p>d. In the <strong>Access policies</strong> section, click <strong>Create</strong>.</p>
</blockquote>
<blockquote>
<p>e. The <strong>Create an access policy</strong> pane appears. In the <strong>Permissions</strong> tab, select the following <strong>Key permissions</strong>:</p>
</blockquote>
<ul>
<li>In the <strong>Key Management Operations</strong> field, select <strong>Get</strong>.</li>
<li>In the <strong>Cryptographic Operations</strong> field, select <strong>Decrypt</strong> and <strong>Encrypt</strong>.</li>
</ul>
<blockquote>
<p>f. Click <strong>Next</strong> to go to the <strong>Principal</strong> tab.</p>
<blockquote>
<p>i. In the <strong>Principal</strong> pane, complete the following steps:</p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p>ii. Enter the application name or application ID in the search box.</p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p>iii. Select the application and click <strong>Select</strong> at the bottom.</p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p>iv. Click <strong>Next</strong> at the bottom.</p>
</blockquote>
</blockquote>
<blockquote>
<p>g. Click <strong>Create</strong> to add the access policy.</p>
</blockquote>
<blockquote>
<p>h. Click the <strong>Networking</strong> tab.</p>
</blockquote>
<blockquote>
<p>i. Select <strong>Enable public access</strong> which allows all networks to connect to this key vault.</p>
</blockquote>
<blockquote>
<p>j. Click the <strong>Tags</strong> tab and you can add tags to categorize your key vault.</p>
</blockquote>
<blockquote>
<p>k. Click <strong>Review + create</strong> to review all of your configurations first, and then click <strong>Create</strong> at the bottom to create the key vault.</p>
</blockquote>
<blockquote>
<p><strong>Note:</strong> If you need to change some settings before creating the key vault, you can click the &lt; Previous button to change previous settings.*</p>
</blockquote>
</li>
<li><p>Create a key.</p>
<blockquote>
<p>a. On the <strong>Key vaults</strong> page, click the newly created key vault.</p>
</blockquote>
<blockquote>
<p>b. Click <strong>Keys</strong> in <strong>Settings</strong>. In the <strong>Keys</strong> pane, click <strong>Generate/Import</strong> and create a key.</p>
</blockquote>
<blockquote>
<p>c. In the <strong>Keys</strong> pane, click the key name, and then click the current version. The key properties are displayed.</p>
</blockquote>
<blockquote>
<p>d. Copy the key identifier. You will need to provide the key identifier when configuring the encryption profile.</p>
</blockquote>
</li>
</ol>
<p>Then, refer to the steps below to prepare the certificate:</p>
<ol>
<li><p>In the Microsoft Azure portal, navigate to <strong>Key vaults</strong>.</p>
</li>
<li><p>On the <strong>Key vaults</strong> page, select a key vault and then select <strong>Certificates</strong> in the left menu.</p>
</li>
<li><p>In the <strong>Certificates</strong> panel, click <strong>Generate/Import</strong> and complete the required fields. The screenshot below is a sample certificate. (In the Content Type field, select <strong>PKCS #12</strong>)</p>
</li>
<li><p>Click <strong>Create</strong> and wait for the <strong>Status</strong> of the certificate to become <strong>Enabled</strong>. You can click <strong>Refresh</strong> to update the status if needed.</p>
</li>
<li><p>Click the name of the certificate, and then select the current version of the certificate.</p>
</li>
<li><p>Click <strong>Download in CER format</strong> and <strong>Download in PFX/PEM format</strong> to download the certificate files to your local machine.</p>
</li>
<li><p>When you have the certificate (<code>.pfx</code> file), you must set a password to protect the certificate.</p>
<blockquote>
<p>a. Open Windows PowerShell and paste the following script. Replace <code>[Full path to your PFX]</code> with the full path of the certificate (<code>.pfx</code> file) on your local machine. Note that quotes are required when you enter the commands.</p>
</blockquote>
<pre><code class="lang-powershell"> $pfxPath=&quot;[Full path to your PFX]&quot;
 Export-PfxCertificate -Password $(Read-Host -AsSecureString -Prompt &quot;Enter a password to protect the certificate&quot;) -PFXData $(Get-PfxData -FilePath $pfxPath) -FilePath $pfxPath
</code></pre>
<blockquote>
<p>b. Press <strong>Enter</strong> to execute the script.</p>
</blockquote>
<blockquote>
<p><strong>Note:</strong> The <code>.pfx</code> file contains your private key.</p>
</blockquote>
</li>
</ol>
<p><strong>Use Windows PowerShell to Prepare Certificates</strong></p>
<p>To create a self-signed certificate using Windows PowerShell, refer to the following steps:</p>
<blockquote>
<p><strong>Note:</strong> The steps below are based on running Windows PowerShell on a machine with the Windows 10 or Windows 11 operating system.</p>
</blockquote>
<ol>
<li><p>Right-click <strong>Windows PowerShell</strong> on the machine and select <strong>Run as administrator</strong> from the drop-down list.</p>
</li>
<li><p>Use the <code>New-SelfSignedCertificate</code> cmdlet to generate certificate files. For example:</p>
<pre><code class="lang-powershell"> $cert = New-SelfSignedCertificate -Subject CN=AvePointCustomApp -CertStoreLocation 'Cert:\CurrentUser\My' -NotAfter (Get-Date).AddMonths(60)
</code></pre>
<p>Press <strong>Enter</strong> on the keyboard.</p>
</li>
<li><p>Export the <code>.crt</code> (or <code>.cer</code>) file by entering the following command:</p>
<pre><code class="lang-powershell"> Export-Certificate -Cert $cert -FilePath AvePointCustomApp.crt
</code></pre>
<p><strong>Note the following:</strong></p>
<ul>
<li><p>If you want to export a <code>.cer</code> file, replace <code>.crt</code> with <code>.cer</code> in the cmdlet above.</p>
</li>
<li><p>The file will be saved to the current working directory of the PowerShell session. To specify a different directory, use the full path, for example:</p>
<pre><code class="lang-powershell">Export-Certificate -Cert $cert -FilePath &quot;C:\\Temp\\AvePointCustomApp.crt&quot;
</code></pre>
</li>
</ul>
</li>
<li><p>Export the <code>.pfx</code> file with a password by entering the following command:</p>
<pre><code class="lang-powershell"> Export-PfxCertificate -Password $(Read-Host -AsSecureString -Prompt &quot;Enter a password to protect the certificate&quot;) -Cert $cert -FilePath AvePointCustomApp.pfx
</code></pre>
<p><strong>Note the following:</strong></p>
<ul>
<li><p>The <code>.pfx</code> file contains your private key.</p>
</li>
<li><p>The file will be saved to the current working directory of the PowerShell session. To specify a different directory, use the full path, for example:</p>
<pre><code class="lang-powershell">Export-PfxCertificate -Password $(Read-Host -AsSecureString -Prompt &quot;Enter a password to protect the certificate&quot;) -Cert $cert -FilePath &quot;C:\\Temp\\AvePointCustomApp.pfx&quot;
</code></pre>
</li>
</ul>
<p>Press <strong>Enter</strong> on the keyboard.</p>
</li>
</ol>
<hr>
<h2 id="get-the-access-token">Get the Access Token</h2>
<p>Based on the credentials of an app registration in Elements, refer to the following sections.</p>
<p><strong>Client Secret</strong></p>
<p>If you want to get the access token with a client secret in an app registration, follow the instructions below to send a POST request:</p>
<ol>
<li>Set the access token URL: <code>https://identity.avepointonlineservices.com/connect/token</code>.</li>
<li>Set the header to <code>Content-Type: application/x-www-form-urlencoded</code>.</li>
<li>Set the following parameters in the request body:
<ul>
<li><code>grant_type</code> – Set this value to <code>client_credentials</code>.</li>
<li><code>client_id</code> – Copy the Application (Client) ID value from the app registration details page and paste the value here.</li>
<li><code>client_secret</code> – Copy the Client Secret value that has been saved upon the creation of the app registration, and paste the value here.</li>
</ul>
</li>
<li>In the response:
<ul>
<li>The <code>access_token</code> node represents the token value.</li>
<li>The <code>expires_in</code> node represents how many seconds until the token expires.</li>
<li>The <code>scope</code> node lists the assigned permissions of the app registration.</li>
</ul>
</li>
</ol>
<p><strong>Certificate</strong></p>
<p>Once you have the application (client) ID, get the access token via the application (client) ID to authenticate with Elements APIs.</p>
<p>The following information is required to get an access token:</p>
<table>
<thead>
<tr>
<th>Element</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Identity Service URL</td>
<td><a href="https://identity.avepointonlineservices.com">https://identity.avepointonlineservices.com</a></td>
</tr>
<tr>
<td>Application (Client) ID</td>
<td>The application (client) ID you have retrieved.</td>
</tr>
<tr>
<td>Certificate</td>
<td>The corresponding <code>.pfx</code> certificate file of the <code>.cer</code> certificate you used when registering the app.</td>
</tr>
</tbody>
</table>
<p>To get the access token using the above information, create a JSON web token using the Client ID and certificate first, and then use the JSON web token to request an access token of the defined scope from Identity Service.</p>
<p>Below is an example for getting the access token:</p>
<pre><code class="lang-csharp">var identityServiceUrl = &quot;{https://identity.avepointonlineservices.com}&quot;;
var client = new HttpClient();
var disco = await client.GetDiscoveryDocumentAsync(identityServiceUrl);
if (disco.IsError)
{
	return;
}
var tokenResponse = await client.RequestClientCredentialsTokenAsync(new ClientCredentialsTokenRequest
{
	Address = disco.TokenEndpoint,
	ClientAssertion = new ClientAssertion()
	{
		Type = OidcConstants.ClientAssertionTypes.JwtBearer,
		Value = CreateClientAuthJwt(disco)
	}
});
if (tokenResponse.IsError)
{    
	return;
}
return tokenResponse.Json;

private static string CreateClientAuthJwt(DiscoveryDocumentResponse response)
{
	var clientId = &quot;{Client ID}&quot;;
	var certificateThumbprint = &quot;{Certificate Thumbprint}&quot;;

	// set exp to 5 minutes
	var tokenHandler = new JwtSecurityTokenHandler { TokenLifetimeInMinutes = 60 };

	var securityToken = tokenHandler.CreateJwtSecurityToken(
		// iss must be the client_id of our application
		issuer: clientId,
		// aud must be the identity provider (token endpoint)
		audience: response.TokenEndpoint,
		// sub must be the client_id of our application
		subject: new ClaimsIdentity(
		  new List&lt;Claim&gt; { new Claim(&quot;sub&quot;, clientId),
		  new Claim(&quot;jti&quot;, Guid.NewGuid().ToString())}),
		// sign with the private key (using RS256 for IdentityServer)
		signingCredentials: new SigningCredentials(
		  new X509SecurityKey(new X509Certificate2(LoadCertificate(certificateThumbprint))), &quot;RS256&quot;)
	);
	return tokenHandler.WriteToken(securityToken);
}

private static X509Certificate2 LoadCertificate(string certificateThumbprint)
{
	var store = new X509Store(StoreName.My, StoreLocation.LocalMachine);
	store.Open(OpenFlags.ReadOnly);
	var vCloudCertificate = store.Certificates.Find(
			X509FindType.FindByThumbprint,
			certificateThumbprint,
			false)[0];
	return vCloudCertificate;
}
</code></pre>
<blockquote>
<p><strong>Note:</strong>
The token you get will expire in one hour, and you need to get the token again after the expiration.</p>
</blockquote>

</article>


        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Copyright © 2025 AvePoint® Inc. All Rights Reserved.<br>Generated with <strong>AvePoint, Inc.</strong></span>
        </div>
      </div>
    </footer>
  </body>
</html>
