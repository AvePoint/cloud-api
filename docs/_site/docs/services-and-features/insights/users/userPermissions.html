<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Retrieve User Permissions </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Retrieve User Permissions ">
      
      
      <link rel="icon" href="../../../../favicon.ico">
      <link rel="stylesheet" href="../../../../public/docfx.min.css">
      <link rel="stylesheet" href="../../../../public/main.css">
      <meta name="docfx:navrel" content="../../../../toc.html">
      <meta name="docfx:tocrel" content="../../../toc.html">
      
      <meta name="docfx:rel" content="../../../../">
      
      
      
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../../../../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../../../../index.html">
            <img id="logo" class="svg" src="../../../../logo.svg" alt="">
            
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="retrieve-user-permissions">Retrieve User Permissions</h1>

<p>Retrieve the permission-related information for specific users. By invoking the <code>/insights/users/access</code> endpoint, you can retrieve the permissions of specific users. This method is useful for obtaining detailed insights into the permissions granted to users.</p>
<h2 id="permission">Permission</h2>
<p>The following permission is required to call this API.<br>
You must register an app through AvePoint Online Services &gt; App registration to authenticate and authorize your access to AvePoint Graph API. For details, refer to <a href="https://learn.avepoint.com/docs/Use-AvePoint-Graph-API.html#authentication-and-authorization">Authentication and Authorization</a>.</p>
<table>
<thead>
<tr>
<th>API</th>
<th>Permission required</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/insights/users/access</code></td>
<td>insights.graph.readwrite.all</td>
</tr>
</tbody>
</table>
<h2 id="request">Request</h2>
<p>This section outlines the HTTP method and endpoint used to retrieve user permissions. It provides a concise description of the action performed by the API call.</p>
<table>
<thead>
<tr>
<th>HTTP Method</th>
<th>Endpoint</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td><code>/insights/users/access</code></td>
<td>Retrieves the user permissions.</td>
</tr>
</tbody>
</table>
<h2 id="query-parameters">Query Parameters</h2>
<p>The API supports several query parameters to refine and customize the data retrieval process. These parameters allow users to specify the site URLs, email addresses, and next link to filter the results effectively.</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Type</th>
<th>Required?</th>
</tr>
</thead>
<tbody>
<tr>
<td>siteUrls</td>
<td>Sets the URLs of site collections for which you want to get the permission related information.</td>
<td>list</td>
<td>No</td>
</tr>
<tr>
<td>emails</td>
<td>Sets the email addresses or logonName of users for which you want to export the permission report.</td>
<td>list</td>
<td>Yes</td>
</tr>
<tr>
<td>nextLink</td>
<td>Sets whether to get the remaining results of a request of which the results are more than 100.</td>
<td>string</td>
<td>No</td>
</tr>
</tbody>
</table>
<h2 id="responses">Responses</h2>
<p>The API response provides detailed information about the user permissions retrieved. Each user permission in the response includes various attributes that describe its properties and status.</p>
<table>
<thead>
<tr>
<th>Elements</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>status</td>
<td>The HTTP response status code</td>
<td>integer</td>
</tr>
<tr>
<td>message</td>
<td>The error message</td>
<td>string</td>
</tr>
<tr>
<td>nextLink</td>
<td>The token to be used to get the remaining results of this request</td>
<td>string</td>
</tr>
<tr>
<td>values</td>
<td>A list of user permission objects</td>
<td>list</td>
</tr>
</tbody>
</table>
<p><strong>User permission</strong></p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>module</td>
<td>The module where the object is located.</td>
<td>string</td>
</tr>
<tr>
<td>siteName</td>
<td>The name of the site where the object is stored.</td>
<td>string</td>
</tr>
<tr>
<td>name</td>
<td>The name of the object.</td>
<td>string</td>
</tr>
<tr>
<td>location</td>
<td>The URL where the object is located.</td>
<td>string</td>
</tr>
<tr>
<td>objectType</td>
<td>The type of object.</td>
<td>string</td>
</tr>
<tr>
<td>inheritType</td>
<td>Indicates whether the permissions are unique to this object.</td>
<td>string</td>
</tr>
<tr>
<td>permission</td>
<td>The level of permission granted.</td>
<td>string</td>
</tr>
<tr>
<td>sensitivityLevel</td>
<td>The sensitivity level of the object.</td>
<td>string</td>
</tr>
<tr>
<td>sensitiveInfoType</td>
<td>Types of sensitive information contained in the file.</td>
<td>string</td>
</tr>
<tr>
<td>isDirect</td>
<td>Indicates whether the permission is direct or inherited.</td>
<td>boolean</td>
</tr>
<tr>
<td>sensitivityLabel</td>
<td>The sensitivity label applied to the object.</td>
<td>string</td>
</tr>
<tr>
<td>inheritedFrom</td>
<td>The source from which the permissions are inherited.</td>
<td>string</td>
</tr>
</tbody>
</table>
<h2 id="request-sample">Request Sample</h2>
<p>To use this API, send a <code>GET</code> request to the specified endpoint, including necessary parameters as defined. This will return the relevant user permissions in a structured format, enabling easy integration with other systems or applications. The following request is an API call to the Insights environment in the US - East region.</p>
<pre><code class="lang-json">https://graph-us.avepointonlineservices.com/insights/users/access?siteUrls=https%3A%2F%2Fm********.sharepoint.com%2Fsites%2Fj*******m01&amp;siteUrls=https%3A%2F%2Fm*****.sharepoint.com%2Fsites%2Fjuly2022publict****&amp;emails=insights****001_j***insightstest.onmicrosoft.com%23ext%23%40m******.onmicrosoft.com&amp;emails=insights******003_j****insightstest.onmicrosoft.com%23ext%23%40m********.onmicrosoft.com
</code></pre>
<h2 id="response-sample">Response Sample</h2>
<p>The following is a sample response for this API method, which includes the permission details of users. Each property in response is explained with a comment for better understanding.</p>
<pre><code class="lang-json">{
    &quot;values&quot;: [
        {
            &quot;module&quot;: &quot;Microsoft Teams&quot;,  // The module where the file is located.
            &quot;siteName&quot;: &quot;AutoC************Team&quot;,  // The name of the site where the file is stored.
            &quot;name&quot;: &quot;U.S. Personally Identifiable Information (PII) Data-High.docx&quot;,  // The name of the file.
            &quot;location&quot;: &quot;https://m365x******.sharepoint.com/sites/autocreated********team/shared documents/general/u.s. personally identifiable information (pii) data-high.docx&quot;,  // The URL where the file is located. 
            &quot;objectType&quot;: &quot;File&quot;,  // The type of object, which is a file in this case.
            &quot;inheritType&quot;: &quot;Unique&quot;,  // Indicates that the permissions are unique to this file.
            &quot;permission&quot;: &quot;Contribute&quot;,  // The level of permission granted.
            &quot;sensitivityLevel&quot;: &quot;High&quot;,  // The sensitivity level of the file.
            &quot;sensitiveInfoType&quot;: &quot;U.S. Individual Taxpayer Identification Number (ITIN), U.S. Social Security Number (SSN), U.S. / U.K. Passport Number&quot;,  // Types of sensitive information contained in the file.
            &quot;isDirect&quot;: false,  // Indicates whether the permission is direct or inherited.
            &quot;sensitivityLabel&quot;: &quot;&quot;,  // The sensitivity label applied to the file, which is empty in this case.
            &quot;inheritedFrom&quot;: &quot;sharinglinks.2nnn3-5nnn-46nn7-bc32-8nnnnnnnnn.flexible.8nnnnnnnnn-c62b0-c62b0-c62b0-c62b0&quot;  // The source from which the permissions are inherited.
        }
    ],
    &quot;status&quot;: 200,  // The status code of the response, indicating success.
    &quot;message&quot;: &quot;&quot;,  // Any message included in the response, which is empty in this case.
    &quot;nextLink&quot;: &quot;fBMkYtVSN7/fBMGW+IDEbl3n2kYtVSN772/fBMGW+IDEbl3n2kYtVSN7fBMGW+IDEbl3n2kYtVSN7KyI3/0SeNe2gz8WjwRAJpKFfBMGW+IDEbl3n2kYtVSN7Fyx+eX/zgxCVPhsSowunsQcfDfBMGW+IDEbl3n2kYtVSN7LSZ76fBMGW+IDEbl3n2kYtVSN7KYyGQ==&quot;  // The next link for pagination, if more data is available.
}
</code></pre>

</article>


        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Copyright © 2025 AvePoint® Inc. All Rights Reserved.<br>Generated with <strong>AvePoint, Inc.</strong></span>
        </div>
      </div>
    </footer>
  </body>
</html>
